@{
    ViewData["Title"] = "AddVideoToCourse";
}
@model Lecture_Videos
<div class="container-xxl py-5 shadow-lg p-3 mb-5 bg-white rounded">
    <div class="container">
        <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
            <h6 class="section-title bg-white text-center text-primary px-3">Add Video</h6>
            <h1 class="mb-5">Create a New Course</h1>
        </div>
        <form id="videoUploadForm" enctype="multipart/form-data">
            <div class="row g-4">
                <!-- Title Input -->
                <div class="col-lg-6 col-md-12 wow fadeInUp" data-wow-delay="0.1s">
                    <div class="form-group">
                        <label class="form-label">Video Title</label>
                        <input type="text" name="Title" class="form-control" placeholder="Enter Title" required />
                    </div>
                </div>

                <!-- Video File Input -->
                <div class="col-lg-6 col-md-12 wow fadeInUp" data-wow-delay="0.3s">
                    <div class="form-group">
                        <label class="form-label">Upload Video</label>
                        <input type="file" id="videoFile" name="VideoFile" class="form-control" accept="video/*" required />
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="col-lg-12 col-md-12 text-center wow fadeInUp" data-wow-delay="0.5s">
                    <div class="progress" style="height: 25px;">
                        <div id="progressBar" class="progress-bar progress-bar-striped bg-success"
                             role="progressbar" style="width: 0%;" aria-valuenow="0"
                             aria-valuemin="0" aria-valuemax="100">
                            0%
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="col-lg-12 col-md-12 text-center wow fadeInUp" data-wow-delay="0.7s">
                    <button type="submit" class="btn btn-primary py-3 px-5 mt-3">Upload Video</button>
                </div>
            </div>
        </form>




    </div>
</div>
<!-- jQuery CDN -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- JavaScript for Handling File Upload -->
<script>
    $(document).ready(function () {
        $('#videoUploadForm').submit(function (e) {
            e.preventDefault(); // Prevent form from submitting normally

            var formData = new FormData(this);

            $.ajax({
                url: '@Url.Action("AddVideoToCourse", "Course")',
                type: 'POST',
                data: formData,
                contentType: false, // Prevent jQuery from setting content-type
                processData: false, // Prevent jQuery from processing data
                xhr: function () {
                    var xhr = new window.XMLHttpRequest();
                    xhr.upload.addEventListener('progress', function (e) {
                        if (e.lengthComputable) {
                            var percentComplete = (e.loaded / e.total) * 100;
                            $('#progressBar').css('width', percentComplete + '%');
                            $('#progressBar').attr('aria-valuenow', percentComplete);
                            $('#progressBar').text(Math.round(percentComplete) + '%');
                        }
                    }, false);
                    return xhr;
                },
                success: function () {
                    alert('Video uploaded successfully!');
                    $('#progressBar').css('width', '0%').text('0%');
                },
                error: function () {
                    alert('An error occurred during the upload.');
                    $('#progressBar').css('width', '0%').text('0%');
                }
            });
        });
    });
</script>
